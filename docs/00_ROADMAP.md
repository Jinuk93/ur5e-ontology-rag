# UR5e Ontology RAG - 개발 로드맵

> 이 문서는 **현업 개발 순서**를 기준으로 작성되었습니다.
> 각 Phase를 순서대로 진행하면서 학습과 구현을 병행합니다.

---

## 전체 파이프라인 개요

```
┌─────────────────────────────────────────────────────────────────┐
│                        OFFLINE (배치/준비)                       │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐       │
│  │  PDF    │───▶│  Parse  │───▶│  Chunk  │───▶│ ChromaDB│     │
│  │ 문서들   │    │ (텍스트) │   │ (조각화) │    │ (벡터DB)  │     │
│  └─────────┘    └─────────┘    └─────────┘    └─────────┘       │
│                                                                 │
│  ┌─────────┐    ┌─────────┐                                     │
│  │ontology │───▶│  Neo4j  │                                    │
│  │  .json  │    │(그래프DB)│                                    │
│  └─────────┘    └─────────┘                                     │
└─────────────────────────────────────────────────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                        ONLINE (실시간 서빙)                      │
│                                                                 │
│  사용자 질문                                                     │
│       │                                                         │
│       ▼                                                         │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐       │
│  │Extractor│──▶│ Linker  │──▶│Reasoner │──▶│Retriever│        │ 
│  │(엔티티   │   │(온톨로지 │    │(그래프   │    │(문서    │       │
│  │ 추출)    │   │ 매핑)    │   │ 추론)    │    │ 검색)   │       │
│  └─────────┘    └─────────┘    └─────────┘    └─────────┘       │
│                                      │              │           │
│                                      ▼              ▼           │
│                               ┌─────────────────────┐           │
│                               │     Verifier        │           │
│                               │  (근거 검증 게이트)  │           │
│                               └─────────────────────┘           │
│                                      │                          │
│                                      ▼                          │
│                               ┌─────────────────────┐           │
│                               │    Formatter        │           │
│                               │  (답변 생성/포맷)    │           │
│                               └─────────────────────┘           │
│                                      │                          │
│                                      ▼                          │
│                                  최종 답변                       │
└─────────────────────────────────────────────────────────────────┘
```

---

## Phase 목록

| Phase | 제목 | 핵심 학습 내용 | 난이도 |
|-------|------|---------------|--------|
| **0** | 개발 환경 설정 | Python, 가상환경, 의존성 관리 | ★☆☆☆☆ |
| **1** | 데이터 탐색 | PDF 열어보기, 구조 파악 | ★☆☆☆☆ |
| **2** | PDF 파싱 & 청킹 | PyMuPDF, 텍스트 추출, 청킹 전략 | ★★☆☆☆ |
| **3** | 벡터DB 인덱싱 | Embedding, ChromaDB 저장 | ★★☆☆☆ |
| **4** | 온톨로지 설계 | 지식그래프, Neo4j, Cypher | ★★★☆☆ |
| **5** | 기본 RAG 구현 | 검색 + LLM 답변 생성 | ★★★☆☆ |
| **6** | 온톨로지 추론 | 엔티티 링킹, 그래프 탐색 | ★★★★☆ |
| **7** | Verifier 구현 | 근거 검증, 안전 정책 | ★★★☆☆ |
| **8** | API 서버 구축 | FastAPI, 엔드포인트 설계 | ★★★☆☆ |
| **9** | UI 대시보드 | Streamlit, 시각화 | ★★☆☆☆ |
| **10** | 테스트 & 평가 | 품질 측정, 개선 | ★★★☆☆ |

---

## 각 Phase 상세 설명

### Phase 0: 개발 환경 설정
**왜 먼저?** 코드를 실행할 환경이 없으면 아무것도 할 수 없음

- Python 설치 확인
- 가상환경(venv) 생성
- 필요한 라이브러리 설치
- Docker 설치 (Neo4j, ChromaDB용)
- IDE/에디터 설정

**산출물:** 동작하는 개발 환경

---

### Phase 1: 데이터 탐색
**왜 먼저?** 데이터를 모르면 설계를 못함

- PDF 3개 직접 열어보기
- 문서 구조 파악 (목차, 섹션, 에러코드 테이블 등)
- 어떤 정보를 추출할지 계획
- 샘플 질문-답변 쌍 만들어보기

**산출물:** 데이터 분석 노트

---

### Phase 2: PDF 파싱 & 청킹
**왜?** PDF는 그대로 검색할 수 없음 → 텍스트로 변환 필요

- PyMuPDF로 텍스트 추출
- 페이지별/섹션별 분리
- 청킹 전략 (크기, 오버랩)
- 메타데이터 기록 (doc_id, page, section)

**산출물:** `chunk_manifest.jsonl`, 파싱된 텍스트 파일들

---

### Phase 3: 벡터DB 인덱싱
**왜?** "의미적으로 유사한" 문서를 찾으려면 벡터 검색 필요

- Embedding이 뭔지 이해
- OpenAI Embedding API 사용법
- ChromaDB에 저장하는 법
- 간단한 검색 테스트

**산출물:** ChromaDB에 인덱싱된 문서

---

### Phase 4: 온톨로지 설계
**왜?** 단순 검색으로는 "원인→조치" 논리를 못 잡음

- 지식그래프가 뭔지 이해
- Node/Relationship 설계
- `ontology.json` 작성
- Neo4j에 적재
- Cypher 쿼리 기초

**산출물:** Neo4j에 적재된 온톨로지 그래프

---

### Phase 5: 기본 RAG 구현
**왜?** 최소 동작하는 버전(MVP) 먼저 만들기

- 질문 → 검색 → LLM 답변 흐름
- OpenAI API 사용법
- 프롬프트 엔지니어링 기초
- 간단한 테스트

**산출물:** 질문하면 답변하는 기본 시스템

---

### Phase 6: 온톨로지 추론
**왜?** "온톨로지 우선" 철학 구현 - 검색 전에 구조화

- 자연어에서 엔티티 추출
- 온톨로지 노드에 매핑(링킹)
- 그래프 경로 탐색
- Query Expansion (검색어 확장)

**산출물:** 온톨로지 기반 추론 모듈

---

### Phase 7: Verifier 구현
**왜?** 근거 없는 답변은 위험함 - 안전장치

- PASS/ABSTAIN/FAIL 정책
- 문서 근거 확인 로직
- Action에 citation 강제

**산출물:** 근거 검증 모듈

---

### Phase 8: API 서버 구축
**왜?** UI와 백엔드를 분리하기 위해

- FastAPI 기초
- 엔드포인트 설계 (/query, /evidence, /health)
- 요청/응답 스키마
- 에러 처리

**산출물:** 동작하는 API 서버

---

### Phase 9: UI 대시보드
**왜?** 사용자가 실제로 쓸 화면

- Streamlit 기초
- 질문 입력 / 답변 표시
- 근거 PDF 미리보기
- 그래프 경로 시각화

**산출물:** 데모 가능한 대시보드

---

### Phase 10: 테스트 & 평가
**왜?** 품질 검증 없이는 "완성"이 아님

- 테스트 케이스 작성
- 평가 지표 측정
- 개선점 도출

**산출물:** 평가 보고서

---

## 문서 구조

```
docs/
├── 00_ROADMAP.md           ← 현재 문서 (전체 로드맵)
├── Spec.md                 ← 기술 설계서 (상세 스펙)
├── Phase0_환경설정.md
├── Phase1_데이터탐색.md
├── Phase2_PDF파싱.md
├── Phase3_벡터인덱싱.md
├── Phase4_온톨로지.md
├── Phase5_기본RAG.md
├── Phase6_온톨로지추론.md
├── Phase7_Verifier.md
├── Phase8_API서버.md
├── Phase9_UI.md
├── Phase10_테스트평가.md
└── LESSONS_LEARNED.md      ← 개발 중 배운 점/트러블슈팅
```

---

## 진행 원칙

1. **한 Phase씩** - 다음 Phase로 넘어가기 전에 현재 Phase 완료
2. **문서 먼저** - 코드 작성 전에 "왜, 어떻게"를 문서로 정리
3. **작은 단위로** - 한 번에 100줄보다 10줄씩 10번
4. **자주 테스트** - 코드 조금 쓰고 바로 실행해보기
5. **모르면 질문** - 막히면 바로 물어보기

---

## 현재 상태

- [x] Spec.md 작성 완료
- [x] 폴더 구조 생성 완료
- [x] PDF 문서 확보 (3개)
- [ ] **Phase 0: 개발 환경 설정** ← 다음 단계

---

*마지막 업데이트: 2025-01-20*
