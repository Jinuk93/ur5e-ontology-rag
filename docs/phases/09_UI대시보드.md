# Phase 9: UI ëŒ€ì‹œë³´ë“œ

> **ìƒíƒœ**: âœ… ì™„ë£Œ
> **ë„ë©”ì¸**: ì„œë¹™ ë ˆì´ì–´ (Serving)
> **ëª©í‘œ**: Streamlit ê¸°ë°˜ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

---

## 1. ê°œìš”

RAG ì‹œìŠ¤í…œì„ ì‚¬ìš©ìê°€ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì›¹ ëŒ€ì‹œë³´ë“œë¥¼ êµ¬í˜„í•˜ëŠ” ë‹¨ê³„.
ì§ˆë¬¸ ì…ë ¥, ë‹µë³€ í‘œì‹œ, ê·¼ê±° ì‹œê°í™”, ê·¸ë˜í”„ íƒìƒ‰ ê¸°ëŠ¥ í¬í•¨.

---

## 2. íƒœìŠ¤í¬

| # | íƒœìŠ¤í¬ | ìƒíƒœ |
|---|--------|------|
| 1 | í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ê³„ | âœ… |
| 2 | RAG Query í˜ì´ì§€ êµ¬í˜„ | âœ… |
| 3 | Knowledge Graph í˜ì´ì§€ êµ¬í˜„ | âœ… |
| 4 | Search Explorer í˜ì´ì§€ êµ¬í˜„ | âœ… |
| 5 | UI ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš©í™” | âœ… |

---

## 3. ëŒ€ì‹œë³´ë“œ êµ¬ì¡°

### 3.1 í˜ì´ì§€ êµ¬ì„±

```
src/dashboard/
â”œâ”€â”€ app.py                    # ë©”ì¸ ì•± (ë©€í‹°í˜ì´ì§€)
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ 1_rag_query.py       # RAG ì§ˆì˜ì‘ë‹µ
â”‚   â”œâ”€â”€ 2_knowledge_graph.py # ì§€ì‹ê·¸ë˜í”„ íƒìƒ‰
â”‚   â”œâ”€â”€ 3_search_explorer.py # ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ 4_performance.py     # ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
â”‚   â””â”€â”€ 5_sensor_analysis.py # ì„¼ì„œ ë¶„ì„ (Phase 19 ì¶”ê°€)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ answer_card.py       # ë‹µë³€ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ source_viewer.py     # ì¶œì²˜ ë·°ì–´
â”‚   â”œâ”€â”€ graph_viewer.py      # ê·¸ë˜í”„ ì‹œê°í™”
â”‚   â””â”€â”€ evidence.py          # ê·¼ê±° í‘œì‹œ ì»´í¬ë„ŒíŠ¸
â””â”€â”€ services/
    â””â”€â”€ api_client.py        # API í´ë¼ì´ì–¸íŠ¸
```

### 3.2 í˜ì´ì§€ ì„¤ëª…

| í˜ì´ì§€ | ê¸°ëŠ¥ |
|--------|------|
| RAG Query | ë©”ì¸ ì§ˆì˜ì‘ë‹µ (ì§ˆë¬¸ ì…ë ¥ â†’ ë‹µë³€ + ì¶œì²˜) |
| Knowledge Graph | ì—ëŸ¬ì½”ë“œ/ì»´í¬ë„ŒíŠ¸ ê·¸ë˜í”„ íƒìƒ‰ |
| Search Explorer | ë²¡í„° ê²€ìƒ‰ ì§ì ‘ í…ŒìŠ¤íŠ¸ |
| Performance | API ì‘ë‹µ ì‹œê°„, ê²€ìƒ‰ í’ˆì§ˆ ëª¨ë‹ˆí„°ë§ |
| Sensor Analysis | ì„¼ì„œ ë°ì´í„° ì‹œê°í™” (Phase 19) |

---

## 4. êµ¬í˜„

### 4.1 ë©”ì¸ ì•±

```python
# src/dashboard/app.py

import streamlit as st

st.set_page_config(
    page_title="UR5e Error Diagnosis",
    page_icon="ğŸ¤–",
    layout="wide"
)

st.title("ğŸ¤– UR5e Error Diagnosis System")
st.markdown("UR5e ë¡œë´‡ ì—ëŸ¬ ì§„ë‹¨ ë° í•´ê²°ì±… ì œê³µ ì‹œìŠ¤í…œ")

# ì‚¬ì´ë“œë°” ë©”ë‰´
st.sidebar.title("Navigation")
st.sidebar.markdown("""
- **RAG Query**: ì§ˆë¬¸í•˜ê³  ë‹µë³€ë°›ê¸°
- **Knowledge Graph**: ì§€ì‹ê·¸ë˜í”„ íƒìƒ‰
- **Search Explorer**: ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
- **Performance**: ì‹œìŠ¤í…œ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
- **Sensor Analysis**: ì„¼ì„œ ë°ì´í„° ë¶„ì„
""")
```

### 4.2 RAG Query í˜ì´ì§€

```python
# src/dashboard/pages/1_rag_query.py

import streamlit as st
from src.dashboard.services.api_client import APIClient
from src.dashboard.components.answer_card import render_answer
from src.dashboard.components.source_viewer import render_sources

st.title("ğŸ” RAG Query")

# API í´ë¼ì´ì–¸íŠ¸
api = APIClient()

# ì§ˆë¬¸ ì…ë ¥
question = st.text_input(
    "ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”",
    placeholder="ì˜ˆ: C154A3 ì—ëŸ¬ì˜ ì›ì¸ê³¼ í•´ê²° ë°©ë²•ì€?"
)

if st.button("ì§ˆë¬¸í•˜ê¸°", type="primary"):
    if question:
        with st.spinner("ë‹µë³€ ìƒì„± ì¤‘..."):
            response = api.query(question)

            # ë‹µë³€ í‘œì‹œ
            st.subheader("ğŸ’¡ ë‹µë³€")
            render_answer(response)

            # ì¶œì²˜ í‘œì‹œ
            st.subheader("ğŸ“š ì¶œì²˜")
            render_sources(response.sources)

            # ê²€ì¦ ìƒíƒœ í‘œì‹œ
            st.subheader("âœ… ê²€ì¦")
            status = response.verification.status
            if status == "pass":
                st.success(f"ê²€ì¦ í†µê³¼ (ì‹ ë¢°ë„: {response.verification.confidence:.0%})")
            elif status == "abstain":
                st.warning("ê·¼ê±° ë¶ˆì¶©ë¶„ - ì¶”ê°€ í™•ì¸ í•„ìš”")
            else:
                st.error("ê²€ì¦ ì‹¤íŒ¨")

            # ê²½ê³  í‘œì‹œ
            if response.verification.warnings:
                for warning in response.verification.warnings:
                    st.warning(warning)
```

### 4.3 ë‹µë³€ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸

```python
# src/dashboard/components/answer_card.py

import streamlit as st

def render_answer(response):
    """ë‹µë³€ì„ ì¹´ë“œ í˜•íƒœë¡œ í‘œì‹œ"""
    with st.container():
        st.markdown(f"""
        <div style="
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 10px;
            color: white;
        ">
            {response.answer}
        </div>
        """, unsafe_allow_html=True)

        # ì²˜ë¦¬ ì‹œê°„
        st.caption(f"â±ï¸ ì²˜ë¦¬ ì‹œê°„: {response.processing_time_ms}ms")
        st.caption(f"ğŸ”— Trace ID: {response.trace_id}")
```

### 4.4 Knowledge Graph í˜ì´ì§€

```python
# src/dashboard/pages/2_knowledge_graph.py

import streamlit as st
from pyvis.network import Network

st.title("ğŸ•¸ï¸ Knowledge Graph")

# ê²€ìƒ‰ íƒ€ì… ì„ íƒ
search_type = st.radio("ê²€ìƒ‰ ìœ í˜•", ["ì—ëŸ¬ì½”ë“œ", "ì»´í¬ë„ŒíŠ¸"])

if search_type == "ì—ëŸ¬ì½”ë“œ":
    code = st.text_input("ì—ëŸ¬ì½”ë“œ ì…ë ¥", placeholder="C154A3")
    if code and st.button("ê²€ìƒ‰"):
        result = api.get_error_graph(code)
        render_graph(result)

elif search_type == "ì»´í¬ë„ŒíŠ¸":
    component = st.selectbox("ì»´í¬ë„ŒíŠ¸ ì„ íƒ", [
        "Control Box", "Teach Pendant", "Joint 0", "Joint 1",
        "Joint 2", "Joint 3", "Joint 4", "Joint 5"
    ])
    if st.button("ê²€ìƒ‰"):
        result = api.get_component_graph(component)
        render_graph(result)

def render_graph(data):
    """PyVisë¡œ ê·¸ë˜í”„ ì‹œê°í™”"""
    net = Network(height="500px", width="100%", bgcolor="#222222")

    for node in data.nodes:
        net.add_node(node.id, label=node.label, color=node.color)

    for edge in data.edges:
        net.add_edge(edge.source, edge.target, label=edge.label)

    net.save_graph("graph.html")
    st.components.v1.html(open("graph.html").read(), height=500)
```

---

## 5. ì‚°ì¶œë¬¼

### 5.1 íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ë‚´ìš© | Lines |
|------|------|-------|
| `src/dashboard/app.py` | ë©”ì¸ ì•± | ~50 |
| `src/dashboard/pages/*.py` | í˜ì´ì§€ (5ê°œ) | ~500 |
| `src/dashboard/components/*.py` | ì»´í¬ë„ŒíŠ¸ (4ê°œ) | ~300 |
| `src/dashboard/services/api_client.py` | API í´ë¼ì´ì–¸íŠ¸ | ~100 |

### 5.2 UI ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| ì§ˆë¬¸ ì…ë ¥ | í…ìŠ¤íŠ¸ ì…ë ¥ + ì—”í„°/ë²„íŠ¼ |
| ë‹µë³€ í‘œì‹œ | ì¹´ë“œ í˜•íƒœ, ë§ˆí¬ë‹¤ìš´ ì§€ì› |
| ì¶œì²˜ í‘œì‹œ | ì ‘ê¸°/í¼ì¹˜ê¸°, ì›ë¬¸ ë¯¸ë¦¬ë³´ê¸° |
| ê·¸ë˜í”„ ì‹œê°í™” | PyVis ê¸°ë°˜ ì¸í„°ë™í‹°ë¸Œ ê·¸ë˜í”„ |
| ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ | ê²€ìƒ‰ì–´ ì…ë ¥ â†’ ê²°ê³¼ ëª©ë¡ |

---

## 6. ì‹¤í–‰ ë°©ë²•

```bash
# ëŒ€ì‹œë³´ë“œ ì‹¤í–‰
streamlit run src/dashboard/app.py

# ë˜ëŠ” í¬íŠ¸ ì§€ì •
streamlit run src/dashboard/app.py --server.port 8501
```

**ì ‘ì†**: http://localhost:8501

---

## 7. ìŠ¤í¬ë¦°ìƒ· (UI ë ˆì´ì•„ì›ƒ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– UR5e Error Diagnosis System                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚  ğŸ” RAG Query                                     â”‚
â”‚ ğŸ“‹ Menu â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚         â”‚  â”‚ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”                              â”‚â”‚
â”‚ RAG     â”‚  â”‚ [C154A3 ì—ëŸ¬ì˜ ì›ì¸ê³¼ í•´ê²° ë°©ë²•ì€?    ] [ì§ˆë¬¸] â”‚â”‚
â”‚ Query   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                                                   â”‚
â”‚ Knowledgeâ”‚  ğŸ’¡ ë‹µë³€                                         â”‚
â”‚ Graph   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚         â”‚  â”‚ C154A3ëŠ” Control Box íŒ¬ ì˜¤ì‘ë™ ì—ëŸ¬ì…ë‹ˆë‹¤.     â”‚â”‚
â”‚ Search  â”‚  â”‚ ì›ì¸: íŒ¬ ê³ ì¥, ì¼€ì´ë¸” ë‹¨ì„ , ë¨¼ì§€ ì¶•ì           â”‚â”‚
â”‚ Explorerâ”‚  â”‚ í•´ê²°: íŒ¬ ë™ì‘ í™•ì¸, ì¼€ì´ë¸” ì ê²€, ì²­ì†Œ          â”‚â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚ Sensor  â”‚                                                   â”‚
â”‚ Analysisâ”‚  ğŸ“š ì¶œì²˜                                          â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚         â”‚  â”‚ â–¶ Error Codes p.15 (92%)                      â”‚â”‚
â”‚         â”‚  â”‚ â–¶ Service Manual p.142 (85%)                  â”‚â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] RAG Query í˜ì´ì§€ ë™ì‘
- [x] Knowledge Graph ì‹œê°í™”
- [x] Search Explorer ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
- [x] ì¶œì²˜ í‘œì‹œ ê¸°ëŠ¥
- [x] ê²€ì¦ ìƒíƒœ í‘œì‹œ
- [x] ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ

---

## 9. ë‹¤ìŒ ë‹¨ê³„

â†’ [Phase 10: í‰ê°€ ì‹œìŠ¤í…œ](10_í‰ê°€ì‹œìŠ¤í…œ.md)

---

**Phase**: 9 / 19
**ì‘ì„±ì¼**: 2026-01-22
