# 온톨로지 그래프 사용자 가이드

> 이 문서는 온톨로지(Ontology)와 지식 그래프(Knowledge Graph)를 처음 접하는 분들을 위한 안내서입니다.

---

## 1. 온톨로지란 무엇인가?

### 한 줄 정의
**온톨로지(Ontology)** = "어떤 분야의 지식을 컴퓨터가 이해할 수 있도록 체계적으로 정리한 것"

### 쉬운 비유
병원에 가면 의사들이 사용하는 **의학 용어 사전**이 있습니다. "고혈압"이라는 단어가 무엇인지, "당뇨"와 어떤 관계가 있는지, 어떤 약으로 치료하는지가 정리되어 있죠.

온톨로지도 마찬가지입니다. 우리 시스템에서는:
- "충돌 패턴"이 무엇인지
- 어떤 에러 코드를 발생시키는지
- 어떻게 해결하는지

이런 **지식들 사이의 관계**를 정리해둔 것입니다.

### 왜 필요한가?
AI가 "로봇에서 충돌이 발생했어요"라는 말을 들었을 때, 단순히 텍스트로만 이해하는 게 아니라:

```
충돌 패턴 → C153 에러 발생 가능 → 물리적 충돌이 원인 → 장애물 확인으로 해결
```

이런 **논리적 추론**을 할 수 있게 해줍니다.

---

## 2. 그래프 화면에서 보이는 것들

### 2.1 노드 (Node) - 박스 하나하나

화면에서 보이는 **각각의 박스**를 **노드(Node)**라고 합니다.

```
┌─────────────────┐
│   충돌 패턴      │  ← 이게 하나의 "노드"
│    Pattern      │
└─────────────────┘
```

노드는 **하나의 개념, 하나의 사물, 하나의 정보**를 나타냅니다.

| 화면에서 보이는 것 | 노드 타입 | 설명 |
|------------------|----------|------|
| 충돌 패턴 | Pattern | 센서가 감지한 이상 패턴 |
| C153 안전 정지 | ErrorCode | UR5e 로봇이 출력하는 에러 코드 |
| 물리적 충돌 | Cause | 문제의 원인 |
| 경로 확보 | Resolution | 해결 방법 |
| UR5e 사용자 매뉴얼 | Document | 참고 문서 |
| 주간 근무 | Shift | 작업 시간대 |

**노드 = 지식의 최소 단위**라고 생각하면 됩니다.

### 2.2 엣지 (Edge) - 연결선

노드와 노드 사이를 연결하는 **점선**을 **엣지(Edge)**라고 합니다.

```
┌──────────┐          ┌──────────┐
│ 충돌 패턴 │──TRIGGERS──│   C153   │
└──────────┘          └──────────┘
              ↑
          이게 "엣지"
```

엣지는 **두 개념 사이의 관계**를 나타냅니다.

**중요**: 엣지에는 항상 **방향**과 **의미**가 있습니다.
- `충돌 패턴 → C153` : 충돌 패턴이 C153을 **유발한다(TRIGGERS)**
- 반대로 읽으면: C153은 충돌 패턴**에 의해 유발된다**

### 2.3 관계 타입 (Relation Type) - 엣지의 이름

엣지 위에 적혀있는 `TRIGGERS`, `RESOLVED_BY` 같은 것들이 **관계 타입**입니다.

우리 시스템에서 사용하는 주요 관계 타입:

| 관계 타입 | 의미 | 예시 |
|----------|------|------|
| **TRIGGERS** | A가 B를 유발한다 | 충돌 패턴 → TRIGGERS → C153 |
| **INDICATES** | A가 B를 나타낸다/암시한다 | 충돌 패턴 → INDICATES → 물리적 충돌 |
| **CAUSED_BY** | A의 원인이 B이다 | C153 → CAUSED_BY → 물리적 충돌 |
| **RESOLVED_BY** | A는 B로 해결된다 | 물리적 충돌 → RESOLVED_BY → 경로 확보 |
| **DOCUMENTED_IN** | A가 B에 문서화되어 있다 | C153 → DOCUMENTED_IN → UR5e 매뉴얼 |
| **OCCURS_DURING** | A가 B 시간대에 발생한다 | 충돌 패턴 → OCCURS_DURING → 주간 근무 |
| **PART_OF** | A가 B의 일부이다 | Joint_0 → PART_OF → UR5e |
| **HAS_STATE** | A가 B 상태를 가진다 | Fz 센서 → HAS_STATE → 경고 상태 |

### 실제 화면 예시 해석

```
        ┌──────────────┐
        │   충돌 패턴   │
        │   Pattern    │
        └──────┬───────┘
               │
    ┌──────────┼──────────┬─────────────┐
    │ INDICATES│ TRIGGERS │ TRIGGERS    │ OCCURS_DURING
    ▼          ▼          ▼             ▼
┌────────┐ ┌───────┐ ┌───────┐   ┌──────────┐
│물리적   │ │ C153  │ │ C119  │   │ 주간 근무 │
│ 충돌   │ │안전정지│ │충돌감지│   │  Shift   │
└───┬────┘ └───┬───┘ └───────┘   └──────────┘
    │ RESOLVED_BY  │ DOCUMENTED_IN
    ▼          ▼
┌────────┐ ┌────────────┐
│ 경로   │ │UR5e 사용자 │
│ 확보   │ │  매뉴얼    │
└────────┘ └────────────┘
```

이 그래프를 **문장으로 읽으면**:

1. "충돌 패턴은 물리적 충돌을 **나타낸다(INDICATES)**"
2. "충돌 패턴은 C153 에러를 **유발한다(TRIGGERS)**"
3. "충돌 패턴은 C119 에러를 **유발한다(TRIGGERS)**"
4. "충돌 패턴은 주간 근무 시간대에 **발생한다(OCCURS_DURING)**"
5. "물리적 충돌은 경로 확보로 **해결된다(RESOLVED_BY)**"
6. "C153 에러는 UR5e 사용자 매뉴얼에 **문서화되어 있다(DOCUMENTED_IN)**"

---

## 3. 화면 상단 컨트롤 설명

### 3.1 시작점 선택 (Start Point)

**정의**: 그래프 탐색을 시작할 **중심 노드**를 선택하는 기능

지하철 노선도를 볼 때 "강남역"에서 시작해서 주변을 보는 것처럼,
온톨로지 그래프도 **어떤 노드를 중심으로 볼 것인지** 선택해야 합니다.

**사용 방법**:
1. "시작점 선택" 버튼 클릭
2. 타입별로 필터링 (Pattern, ErrorCode, Cause 등)
3. 검색어로 찾기
4. 원하는 노드 클릭

**예시 시나리오**:
- "C153 에러가 발생했는데, 관련된 정보를 보고 싶다" → C153을 시작점으로 선택
- "충돌 관련 전체 흐름을 보고 싶다" → 충돌 패턴을 시작점으로 선택
- "Fz 센서의 상태 변화를 보고 싶다" → Fz를 시작점으로 선택

### 3.2 Depth (깊이)

**정의**: 시작점에서 몇 단계까지 연결된 노드를 보여줄 것인지

```
Depth 1: 시작점 + 바로 연결된 노드들만
Depth 2: 시작점 + 1단계 + 2단계까지
Depth 3: 시작점 + 1단계 + 2단계 + 3단계까지
Depth 4: 시작점 + 1단계 + 2단계 + 3단계 + 4단계까지
```

**시각적 예시**:

```
Depth 1일 때:
        ┌───────┐
        │충돌패턴│ (시작점)
        └───┬───┘
    ┌───────┼───────┐
    ▼       ▼       ▼
  물리적   C153    C119    ← 여기까지만 보임
  충돌

Depth 2일 때:
        ┌───────┐
        │충돌패턴│ (시작점)
        └───┬───┘
    ┌───────┼───────┐
    ▼       ▼       ▼
  물리적   C153    C119
  충돌      │
    │       ▼
    ▼    UR5e 매뉴얼    ← 2단계까지 보임
 경로확보
```

**언제 깊이를 조절하나?**:
- **Depth 낮게 (1~2)**: 핵심 관계만 빠르게 파악할 때
- **Depth 높게 (3~4)**: 전체 맥락과 연결고리를 파악할 때

**주의**: Depth가 높을수록 노드가 많아져서 복잡해집니다.

### 3.3 초기화 버튼

그래프를 기본 상태(충돌 패턴, Depth 2)로 되돌립니다.

---

## 4. 노드 타입 상세 설명

우리 시스템에는 다음과 같은 노드 타입들이 있습니다:

### 4.1 장비 관련

| 타입 | 설명 | 예시 |
|------|------|------|
| **Robot** | 로봇 장비 | UR5e 협동로봇 |
| **Sensor** | 센서 장비 | Axia80 힘/토크 센서 |
| **Joint** | 로봇의 관절 | Joint_0 (베이스), Joint_1 (어깨) |
| **ControlBox** | 제어 장치 | UR5e Control Box |

### 4.2 측정 관련

| 타입 | 설명 | 예시 |
|------|------|------|
| **MeasurementAxis** | 센서의 측정 축 | Fx, Fy, Fz (힘), Tx, Ty, Tz (토크) |
| **State** | 측정값의 상태 | 정상, 경고, 위험 |

### 4.3 패턴 및 에러

| 타입 | 설명 | 예시 |
|------|------|------|
| **Pattern** | 센서가 감지한 이상 패턴 | 충돌 패턴, 과부하 패턴, 드리프트 패턴 |
| **ErrorCode** | 로봇이 출력하는 에러 코드 | C153, C119, C154 |

### 4.4 원인 및 해결

| 타입 | 설명 | 예시 |
|------|------|------|
| **Cause** | 문제의 원인 | 물리적 충돌, 과도한 부하, 센서 드리프트 |
| **Resolution** | 해결 방법 | 경로 확보, 부하 감소, 센서 재교정 |

### 4.5 참조 정보

| 타입 | 설명 | 예시 |
|------|------|------|
| **Document** | 참고 문서 | UR5e 사용자 매뉴얼, 서비스 매뉴얼 |
| **Shift** | 작업 시간대 | 주간 근무, 야간 근무 |

---

## 5. 관계 타입 상세 설명

### 5.1 TRIGGERS (유발하다)

```
A ──TRIGGERS──▶ B
```

**의미**: A가 발생하면 B가 발생할 수 있다 (인과관계)

**예시**:
- `충돌 패턴` → TRIGGERS → `C153 안전 정지`
  - "충돌 패턴이 감지되면 C153 에러가 발생할 수 있다"

**실무 활용**: 센서에서 특정 패턴이 감지되면 어떤 에러가 발생할 수 있는지 **예측**할 수 있습니다.

### 5.2 INDICATES (나타내다)

```
A ──INDICATES──▶ B
```

**의미**: A는 B를 나타낸다, A는 B의 징후이다

**예시**:
- `충돌 패턴` → INDICATES → `물리적 충돌`
  - "충돌 패턴은 물리적 충돌이 발생했음을 나타낸다"

**TRIGGERS vs INDICATES 차이**:
- TRIGGERS: A가 B를 **발생시킴** (원인 → 결과)
- INDICATES: A가 B를 **암시함** (징후 → 상황)

### 5.3 CAUSED_BY (원인이 ~이다)

```
A ──CAUSED_BY──▶ B
```

**의미**: A의 원인이 B이다

**예시**:
- `C153 에러` → CAUSED_BY → `물리적 충돌`
  - "C153 에러의 원인은 물리적 충돌이다"

**실무 활용**: 에러가 발생했을 때 **근본 원인**을 추적할 수 있습니다.

### 5.4 RESOLVED_BY (해결되다)

```
A ──RESOLVED_BY──▶ B
```

**의미**: A 문제는 B 조치로 해결된다

**예시**:
- `물리적 충돌` → RESOLVED_BY → `경로 확보`
  - "물리적 충돌 문제는 경로 확보 조치로 해결된다"

**실무 활용**: 원인을 파악한 후 **어떻게 조치해야 하는지** 알 수 있습니다.

### 5.5 DOCUMENTED_IN (문서화되다)

```
A ──DOCUMENTED_IN──▶ B
```

**의미**: A에 대한 정보가 B 문서에 있다

**예시**:
- `C153` → DOCUMENTED_IN → `UR5e 사용자 매뉴얼`
  - "C153에 대한 정보는 UR5e 사용자 매뉴얼에 있다"

**실무 활용**: 추가 정보가 필요할 때 **어떤 문서를 참조해야 하는지** 알 수 있습니다.

### 5.6 OCCURS_DURING (발생 시간대)

```
A ──OCCURS_DURING──▶ B
```

**의미**: A가 B 시간대에 자주 발생한다

**예시**:
- `충돌 패턴` → OCCURS_DURING → `주간 근무`
  - "충돌 패턴은 주간 근무 시간대에 자주 발생한다"

**실무 활용**: 특정 문제가 **언제 주로 발생하는지** 패턴을 파악할 수 있습니다.

---

## 6. 실전 활용 시나리오

### 시나리오 1: 에러 발생 시 원인 추적

**상황**: UR5e 로봇에서 C153 에러가 발생했다

**그래프 활용 방법**:
1. 시작점 선택 → C153 검색 → 선택
2. Depth를 2~3으로 설정
3. `CAUSED_BY` 관계를 따라가면 원인 파악
4. 원인에서 `RESOLVED_BY` 관계를 따라가면 해결 방법 확인

### 시나리오 2: 센서 패턴 분석

**상황**: 센서에서 이상한 패턴이 감지되었다

**그래프 활용 방법**:
1. 시작점 선택 → 해당 패턴 (예: 충돌 패턴) 선택
2. `TRIGGERS` 관계를 보면 → 예상되는 에러 코드
3. `INDICATES` 관계를 보면 → 실제 원인이 무엇인지

### 시나리오 3: 예방 정비 계획

**상황**: 특정 시간대에 문제가 자주 발생하는 것 같다

**그래프 활용 방법**:
1. 시작점 선택 → 시간대 (예: 주간 근무) 선택
2. Depth를 1로 설정
3. 해당 시간대에 연결된 패턴들 확인
4. 각 패턴의 원인과 해결책 사전 파악

---

## 7. 용어 정리 (Glossary)

| 용어 | 영문 | 정의 |
|------|------|------|
| 온톨로지 | Ontology | 특정 분야의 지식을 체계적으로 정리한 것 |
| 지식 그래프 | Knowledge Graph | 온톨로지를 그래프 형태로 시각화한 것 |
| 노드 | Node | 그래프에서 하나의 개념/사물을 나타내는 점(박스) |
| 엣지 | Edge | 노드와 노드를 연결하는 선 |
| 관계 | Relation | 두 노드 사이의 의미적 연결 (엣지의 종류) |
| 깊이 | Depth | 시작점에서 몇 단계까지 탐색할 것인지 |
| 시작점 | Start Point / Center | 그래프 탐색의 중심이 되는 노드 |
| 탐색 | Traversal | 그래프에서 연결된 노드들을 따라가며 보는 것 |

---

## 8. 자주 묻는 질문 (FAQ)

### Q: 노드를 클릭하면 뭐가 나오나요?
A: 해당 노드의 상세 정보(타입, 속성, 설명)가 화면 하단에 표시됩니다.

### Q: 노드를 더블클릭하면요?
A: 해당 노드가 새로운 시작점이 되어 그래프가 재구성됩니다.

### Q: Depth를 높이면 왜 느려지나요?
A: Depth가 높을수록 표시해야 할 노드와 엣지가 기하급수적으로 늘어나기 때문입니다.

### Q: 특정 관계만 보고 싶으면요?
A: 현재는 전체 관계가 표시되며, 향후 필터링 기능이 추가될 예정입니다.

### Q: 이 그래프 데이터는 어디서 오나요?
A: 백엔드의 온톨로지 데이터베이스에서 실시간으로 조회됩니다. 온톨로지는 사전에 전문가가 설계하고 입력한 지식입니다.

---

## 9. 정리

```
┌─────────────────────────────────────────────────────────────┐
│                      온톨로지 그래프                         │
├─────────────────────────────────────────────────────────────┤
│  노드 (Node)     = 개념, 사물, 정보 (박스)                    │
│  엣지 (Edge)     = 관계, 연결 (선)                           │
│  관계 타입        = 연결의 의미 (TRIGGERS, CAUSED_BY 등)      │
│  시작점          = 탐색의 중심                               │
│  Depth           = 몇 단계까지 볼 것인지                      │
├─────────────────────────────────────────────────────────────┤
│  핵심 관계:                                                  │
│  • TRIGGERS      → "~가 ~를 유발한다"                        │
│  • INDICATES     → "~가 ~를 나타낸다"                        │
│  • CAUSED_BY     → "~의 원인은 ~이다"                        │
│  • RESOLVED_BY   → "~는 ~로 해결된다"                        │
│  • DOCUMENTED_IN → "~는 ~에 문서화되어 있다"                  │
└─────────────────────────────────────────────────────────────┘
```

이 그래프를 통해 **"왜 이런 일이 발생했고, 어떻게 해결하는지"**를 체계적으로 파악할 수 있습니다.
