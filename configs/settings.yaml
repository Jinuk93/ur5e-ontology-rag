# ============================================================
# settings.yaml - 프로젝트 설정 파일
# ============================================================
# 왜 설정 파일을 쓰나요?
#   1. 코드 수정 없이 설정값 변경 가능
#   2. 환경(개발/운영)별로 다른 설정 적용 가능
#   3. 설정값을 한 곳에서 관리 → 유지보수 편리
#
# YAML 문법:
#   - 들여쓰기로 계층 구조 표현 (스페이스 2칸 권장)
#   - key: value 형태
#   - 리스트는 - 로 표시
# ============================================================


# ------------------------------------------------------------
# [1] 문서 처리 설정 (PDF → 텍스트 → 청크)
# ------------------------------------------------------------
document:
  # 청크(Chunk)란? 긴 문서를 작은 조각으로 나눈 것
  # 왜 나누나요? LLM은 한번에 처리할 수 있는 텍스트 길이에 제한이 있음

  chunk_size: 512              # 청크 하나의 최대 글자 수
                               # 너무 작으면: 문맥 손실
                               # 너무 크면: 검색 정확도 저하

  chunk_overlap: 50            # 청크 간 겹치는 글자 수
                               # 왜 겹치나요? 문장이 중간에 잘리는 것 방지
                               # 예: [....문장A의 끝. 문장B의 시작...]
                               #     청크1: ....문장A의 끝. 문장B
                               #     청크2: 문장A의 끝. 문장B의 시작...


# ------------------------------------------------------------
# [2] 임베딩 설정 (텍스트 → 벡터)
# ------------------------------------------------------------
embedding:
  # 임베딩이란? 텍스트를 숫자 배열(벡터)로 변환
  # 왜 변환하나요? 컴퓨터가 "의미적 유사도"를 계산하려면 숫자가 필요

  model: "text-embedding-3-small"  # OpenAI 임베딩 모델
                                    # small: 빠르고 저렴 (1536 차원)
                                    # large: 더 정확 (3072 차원)

  batch_size: 100                   # 한 번에 임베딩할 텍스트 개수
                                    # API 호출 횟수 줄이기 위해 묶어서 처리


# ------------------------------------------------------------
# [3] 검색 설정 (Retrieval)
# ------------------------------------------------------------
retrieval:
  top_k: 5                         # 검색 시 가져올 문서 개수
                                   # 많으면: 정보 많음, but LLM 처리 부담
                                   # 적으면: 빠름, but 정보 누락 가능

  similarity_threshold: 0.7        # 유사도 임계값 (0.0 ~ 1.0)
                                   # 이 값 미만인 문서는 제외
                                   # 높으면: 정확한 것만, but 검색 결과 적음
                                   # 낮으면: 검색 결과 많음, but 관련 없는 것 포함


# ------------------------------------------------------------
# [4] LLM 설정 (답변 생성)
# ------------------------------------------------------------
llm:
  model: "gpt-4o-mini"             # 사용할 OpenAI 모델
                                   # gpt-4o-mini: 빠르고 저렴
                                   # gpt-4o: 더 정확하지만 비쌈

  temperature: 0.0                 # 응답의 창의성/무작위성 (0.0 ~ 2.0)
                                   # 0.0: 일관된 응답 (팩트 기반 답변에 적합)
                                   # 1.0+: 다양한 응답 (창작에 적합)

  max_tokens: 1024                 # 응답 최대 토큰 수
                                   # 토큰 ≈ 단어 (한글은 1글자 ≈ 1~2토큰)


# ------------------------------------------------------------
# [5] Verifier 설정 (근거 검증)
# ------------------------------------------------------------
verifier:
  # Verifier란? 답변에 근거가 있는지 검증하는 모듈
  # 근거 없으면 "조치(Action)"를 제안하지 않음 → 안전장치

  require_citation_for_action: true   # Action 출력 시 문서 인용 필수 여부

  min_evidence_score: 0.7             # 최소 근거 점수
                                      # 이 점수 미만이면 ABSTAIN(기권)

  max_graph_hops: 3                   # 그래프 탐색 최대 깊이
                                      # 예: 증상 → 원인 → 조치 (3 hops)


# ------------------------------------------------------------
# [6] API 서버 설정
# ------------------------------------------------------------
api:
  host: "0.0.0.0"                  # 서버 바인딩 주소
                                   # 0.0.0.0: 모든 네트워크에서 접근 가능
                                   # 127.0.0.1: 로컬에서만 접근 가능

  port: 8080                       # 서버 포트 번호

  debug: true                      # 디버그 모드 (개발 중에만 true)
                                   # true: 상세 에러 메시지, 자동 리로드
                                   # false: 운영 환경에서는 반드시 false


# ------------------------------------------------------------
# [7] 로깅 설정
# ------------------------------------------------------------
logging:
  level: "INFO"                    # 로그 레벨
                                   # DEBUG: 모든 정보 (개발용)
                                   # INFO: 일반 정보
                                   # WARNING: 경고
                                   # ERROR: 에러만

  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"


# ------------------------------------------------------------
# [8] 관리 감독자 대시보드 목표치(운영 기준선)
# ------------------------------------------------------------
# 목적:
#   - 프론트 통계 요약에서 "목표 대비"를 보여주기 위한 운영 기준 값
#   - 현장/라인/공정에 따라 코드 수정 없이 튜닝 가능
supervisor_targets:
  # 정상 운영률 목표(%)
  normal_rate_min: 90

  # 힘 크기(|F|) 분포 목표(N)
  # - p95가 올라가면 "평상시"가 거칠어졌다고 해석 가능
  force_magnitude_p95_max: 90
  force_magnitude_mean_max: 60

  # Fz 분포 목표(N)
  fz_p95_max_abs: 120

  # 이벤트 운영 목표(일 평균)
  events_daily_max: 2.0
  collision_daily_max: 0.5
  overload_daily_max: 0.5
  drift_daily_max: 0.3

  # MTBE 목표(분)
  mtbe_min_minutes: 60

  # 미해결 이벤트 백로그 허용치
  unresolved_events_max: 5
